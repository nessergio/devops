{
  "title": "Nginx Balancer",
  "uid": "prod-nginx",
  "timezone": "browser",
  "panels": [
    {
      "title": "Average response time",
      "type": "timeseries",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(demo_http_response_time_seconds_sum[5m])) by (instance) / sum(rate(demo_http_response_time_seconds_count[5m])) by (instance)",
          "legendFormat": "{{ instance }}"
        }
      ],
      "timeFrom": "1h",
      "gridPos": { "h": 8, "w": 12 }
    },
    {
      "title": "Requests per second",
      "type": "timeseries",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(demo_http_response_time_seconds_count[5m])) by (instance)",
          "legendFormat": "{{ instance }}"
        }
      ],
      "timeFrom": "1h",
      "gridPos": { "h": 8, "w": 12, "x": 12 }
    },
    {
      "title": "Response time (90% quantile)",
      "type": "timeseries",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "demo_http_response_time_seconds{quantile='0.9',method='GET',status='200'}",
          "legendFormat": "{{ instance }}"
        }
      ],
      "timeFrom": "1h",
      "gridPos": { "h": 8, "w": 12 }
    },
    {
      "title": "HTTP traffic",
      "type": "timeseries",
      "datasource": "Prometheus",
      "fieldConfig": {
        "defaults": {
          "unit": "bytes"
        }
      },
      "targets": [
        {
          "expr": "sum(rate(demo_http_response_size_bytes[5m])) by (instance)",
          "legendFormat": "{{ instance }}"
        }
      ],
      "timeFrom": "1h",
      "gridPos": { "h": 8, "w": 12, "x": 12 }
    },
    {
      "title": "Status codes per second",
      "type": "timeseries",
      "datasource": "Prometheus",
      "targets": [
        {
          "expr": "sum(rate(demo_http_response_count_total[10m])) by (status)",
          "legendFormat": "{{ instance }}"
        }
      ],
      "timeFrom": "1h",
      "gridPos": { "h": 8, "w": 12 }
    }
  ],
  "time": { "from": "now-1h", "to": "now" },
  "timepicker": {
    "refresh_intervals": [
      "5s",
      "10s",
      "30s",
      "1m",
      "5m",
      "15m",
      "30m",
      "1h",
      "2h",
      "1d"
    ],
    "time_options": ["5m", "15m", "1h", "6h", "12h", "24h", "2d", "7d", "30d"]
  }
}
